<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 4: Authentication, Security & Validation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reset.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/theme/black.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/highlight/monokai.css">
    <style>
        .reveal h1, .reveal h2, .reveal h3 { text-transform: none; }
        .reveal pre { font-size: 0.42em; width: 100%; }
        .reveal code { max-height: 500px; }
        .two-column { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .diagram { background: white; padding: 20px; border-radius: 10px; color: black; }
        .highlight-box { background: rgba(255, 200, 0, 0.2); padding: 20px; border-left: 5px solid #ffc800; }
        .danger-box { background: rgba(255, 0, 0, 0.2); padding: 20px; border-left: 5px solid #ff0000; }
        .success-box { background: rgba(0, 255, 0, 0.2); padding: 20px; border-left: 5px solid #00ff00; }
        .warning-box { background: rgba(255, 100, 0, 0.2); padding: 20px; border-left: 5px solid #ff6400; }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">

            <!-- Slide 1: Title -->
            <section data-markdown>
                <textarea data-template>
                    # Module 4
                    ## Authentication, Security & Validation

                    **Pemrograman Web - Semester 3**

                    Duration: 2-3 weeks

                    ---

                    **Building Secure Applications**
                </textarea>
            </section>

            <!-- Slide 2: Learning Objectives -->
            <section data-markdown>
                <textarea data-template>
                    ## Learning Objectives

                    By the end of this module, you will be able to:

                    1. Implement frontend and backend data validation
                    2. Use Jakarta Bean Validation annotations
                    3. Build user authentication system
                    4. Encrypt passwords with BCrypt
                    5. Configure Spring Security
                    6. Implement form-based login
                    7. Set up OAuth2 with Google Login
                    8. Create Role-Based Access Control (RBAC)
                    9. Get current user information
                    10. Manage user sessions
                </textarea>
            </section>

            <!-- Slide 3: Module Overview -->
            <section data-markdown>
                <textarea data-template>
                    ## What We'll Build

                    **Secure Academic System**:

                    - **Validation**: Frontend + Backend validation
                    - **Authentication**: Login with username/password
                    - **OAuth2**: Login with Google account
                    - **Authorization**: Role-based access (Admin vs User)
                    - **Security**: Password encryption with BCrypt
                    - **Session**: Manage logged-in users

                    **Result**: Secure application with proper access control!
                </textarea>
            </section>

            <!-- Section 1: Data Validation -->
            <section>
                <section data-markdown>
                    <textarea data-template>
                        ## 1. Data Validation

                        Ensuring data quality and security
                    </textarea>
                </section>

                <!-- Slide 4 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Why Validation Matters

                        **Without Validation**:
                        ```javascript
                        // User submits:
                        {
                          "nim": "",
                          "name": "a",
                          "email": "not-an-email",
                          "batch": -5
                        }
                        ```

                        **Problems**:
                        - ❌ Empty required fields
                        - ❌ Invalid email format
                        - ❌ Negative numbers
                        - ❌ SQL injection attacks
                        - ❌ XSS (Cross-Site Scripting) attacks
                        - ❌ Poor user experience
                        - ❌ Database integrity issues

                        **Solution**: Validate on BOTH frontend AND backend!
                    </textarea>
                </section>

                <!-- Slide 5 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Frontend Validation (HTML5)

                        **From our project** - Student form:
                        ```html
                        <form @submit.prevent="saveStudent">
                          <!-- Required field -->
                          <div class="mb-3">
                            <label>Name *</label>
                            <input type="text"
                                   v-model="studentForm.name"
                                   class="form-control"
                                   required
                                   minlength="3"
                                   maxlength="100"
                                   pattern="[a-zA-Z\s]+"
                                   placeholder="Enter student name">
                            <div class="invalid-feedback">
                              Name must be 3-100 characters (letters only)
                            </div>
                          </div>

                          <!-- Email validation -->
                          <div class="mb-3">
                            <label>Email *</label>
                            <input type="email"
                                   v-model="studentForm.email"
                                   class="form-control"
                                   required
                                   placeholder="student@email.com">
                          </div>

                          <!-- Number range -->
                          <div class="mb-3">
                            <label>Batch *</label>
                            <input type="number"
                                   v-model="studentForm.batch"
                                   class="form-control"
                                   required
                                   min="2010"
                                   max="2030">
                          </div>

                          <button type="submit" class="btn btn-primary">Save</button>
                        </form>
                        ```
                    </textarea>
                </section>

                <!-- Slide 6 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Frontend Validation (JavaScript)

                        **Custom validation logic**:
                        ```javascript
                        methods: {
                          validateForm() {
                            // Check NIM format (10 digits: AABBBBCCCC)
                            if (this.studentForm.nim && !/^\d{10}$/.test(this.studentForm.nim)) {
                              this.showError('NIM must be exactly 10 digits');
                              return false;
                            }

                            // Check name (only letters and spaces)
                            if (!/^[a-zA-Z\s]+$/.test(this.studentForm.name)) {
                              this.showError('Name must contain only letters and spaces');
                              return false;
                            }

                            // Check email format
                            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                            if (!emailRegex.test(this.studentForm.email)) {
                              this.showError('Invalid email format');
                              return false;
                            }

                            // Check batch range
                            const batch = parseInt(this.studentForm.batch);
                            if (batch < 2010 || batch > 2030) {
                              this.showError('Batch must be between 2010 and 2030');
                              return false;
                            }

                            return true;
                          },

                          saveStudent() {
                            // Validate before sending
                            if (!this.validateForm()) {
                              return;
                            }

                            // Proceed with API call...
                          }
                        }
                        ```
                    </textarea>
                </section>

                <!-- Slide 7 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Jakarta Bean Validation

                        **From our project** - `Student.java`:
                        ```java
                        package com.example.webapp.model;

                        import jakarta.validation.constraints.*;
                        import org.springframework.data.mongodb.core.mapping.Document;

                        @Document(collection = "students")
                        public class Student {
                            @Id
                            private String id;

                            private String nim;  // Validated in service layer

                            @NotBlank(message = "Name is required")
                            @Pattern(regexp = "^[a-zA-Z\\s]+$",
                                     message = "Name must contain only letters (a-z, A-Z) and spaces")
                            private String name;

                            @NotBlank(message = "Email is required")
                            @Email(message = "Email must be a valid email format")
                            private String email;

                            private String major;

                            @NotNull(message = "Batch is required")
                            @Min(value = 2010, message = "Batch must be at least 2010")
                            @Max(value = 2030, message = "Batch must not exceed 2030")
                            private Integer batch;

                            private StudentStatus status;

                            // Getters and setters...
                        }
                        ```
                    </textarea>
                </section>

                <!-- Slide 8 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Common Validation Annotations

                        | Annotation | Purpose | Example |
                        |------------|---------|---------|
                        | `@NotNull` | Field cannot be null | `@NotNull Integer age` |
                        | `@NotBlank` | String not empty/whitespace | `@NotBlank String name` |
                        | `@NotEmpty` | Collection not empty | `@NotEmpty List<String> items` |
                        | `@Size(min, max)` | String/collection size | `@Size(min=3, max=50)` |
                        | `@Min(value)` | Number minimum | `@Min(18) Integer age` |
                        | `@Max(value)` | Number maximum | `@Max(100) Integer percentage` |
                        | `@Email` | Valid email format | `@Email String email` |
                        | `@Pattern(regexp)` | Matches regex | `@Pattern(regexp="\\d{10}")` |
                        | `@Past` | Date in the past | `@Past LocalDate birthDate` |
                        | `@Future` | Date in the future | `@Future LocalDate deadline` |
                        | `@Positive` | Positive number | `@Positive Double price` |
                        | `@PositiveOrZero` | Zero or positive | `@PositiveOrZero Integer count` |
                    </textarea>
                </section>

                <!-- Slide 9 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Subject Entity Validation

                        **From our project** - `Subject.java`:
                        ```java
                        @Data
                        @Document(collection = "subjects")
                        public class Subject {
                            @Id
                            private String id;

                            private String code;  // Auto-generated

                            @NotBlank(message = "Name is required")
                            @Pattern(regexp = "^[a-zA-Z\\s]+$",
                                     message = "Name must contain only letters (a-z, A-Z) and spaces")
                            private String name;

                            @NotBlank(message = "Major is required")
                            private String major;  // Sistem Informasi or Teknologi Informasi

                            @NotNull(message = "SKS is required")
                            @Min(value = 1, message = "SKS must be at least 1")
                            @Max(value = 6, message = "SKS must not exceed 6")
                            private Integer sks;
                        }
                        ```

                        **Validation Rules**:
                        - Name: Required, letters and spaces only
                        - Major: Required
                        - SKS: Required, between 1 and 6
                    </textarea>
                </section>

                <!-- Slide 10 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Controller Validation

                        **From our project** - `StudentController.java`:
                        ```java
                        @RestController
                        @RequestMapping("/api/students")
                        public class StudentController {

                            @PostMapping
                            public ResponseEntity<Student> createStudent(
                                    @Valid @RequestBody Student student) {  // @Valid triggers validation
                                try {
                                    Student savedStudent = studentService.createStudent(student);
                                    return ResponseEntity.status(HttpStatus.CREATED).body(savedStudent);
                                } catch (IllegalArgumentException e) {
                                    return ResponseEntity.badRequest().build();
                                }
                            }

                            @PutMapping("/{id}")
                            public ResponseEntity<Student> updateStudent(
                                    @PathVariable String id,
                                    @Valid @RequestBody Student student) {  // @Valid here too
                                try {
                                    Student updatedStudent = studentService.updateStudent(id, student);
                                    return ResponseEntity.ok(updatedStudent);
                                } catch (IllegalArgumentException e) {
                                    return ResponseEntity.notFound().build();
                                }
                            }
                        }
                        ```

                        **`@Valid`**: Triggers validation before method execution
                    </textarea>
                </section>

                <!-- Slide 11 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Validation Error Handling

                        **From our project** - `StudentController.java`:
                        ```java
                        /**
                         * Handle validation errors globally
                         * Triggered when @Valid fails
                         */
                        @ExceptionHandler(MethodArgumentNotValidException.class)
                        @ResponseStatus(HttpStatus.BAD_REQUEST)
                        public ResponseEntity<Map<String, Object>> handleValidationExceptions(
                                MethodArgumentNotValidException ex) {

                            Map<String, Object> response = new HashMap<>();
                            Map<String, String> errors = new HashMap<>();

                            // Extract all field errors
                            ex.getBindingResult().getAllErrors().forEach((error) -> {
                                String fieldName = ((FieldError) error).getField();
                                String errorMessage = error.getDefaultMessage();
                                errors.put(fieldName, errorMessage);
                            });

                            response.put("message", "Validation failed");
                            response.put("errors", errors);
                            return ResponseEntity.badRequest().body(response);
                        }
                        ```

                        **Response Example**:
                        ```json
                        {
                          "message": "Validation failed",
                          "errors": {
                            "name": "Name is required",
                            "email": "Email must be a valid email format",
                            "batch": "Batch must be at least 2010"
                          }
                        }
                        ```
                    </textarea>
                </section>
            </section>

            <!-- Section 2: Authentication Basics -->
            <section>
                <section data-markdown>
                    <textarea data-template>
                        ## 2. User Authentication

                        Building a secure login system
                    </textarea>
                </section>

                <!-- Slide 12 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Authentication vs Authorization

                        **Authentication**: *Who are you?*
                        - Verifying user identity
                        - Login with username/password
                        - Login with OAuth2 (Google, Facebook)
                        - Biometric authentication

                        **Authorization**: *What can you do?*
                        - Verifying user permissions
                        - Role-based access (Admin, User)
                        - Resource-level permissions
                        - Action-level permissions

                        **Example**:
                        1. **Authentication**: User "admin" logs in with password ✅
                        2. **Authorization**: Admin can delete students, User cannot ✅
                    </textarea>
                </section>

                <!-- Slide 13 -->
                <section>
                    <h3>Authentication Flow</h3>
                    <div class="diagram">
                        <pre style="color: black; font-size: 0.65em;">
    1. User visits protected page
       ┌──────────────┐
       │   Browser    │  GET /students
       └──────────────┘
              │
              ▼
    2. Not authenticated → Redirect to login
       ┌──────────────────┐
       │  Spring Security │  302 Redirect → /login
       └──────────────────┘
              │
              ▼
    3. User enters credentials
       ┌──────────────┐
       │ Login Form   │  POST /login
       │ username: admin
       │ password: ****
       └──────────────┘
              │
              ▼
    4. Spring Security verifies
       ┌───────────────────────────┐
       │ UserDetailsService        │
       │ - Load user from DB       │
       │ - Check password (BCrypt) │
       └───────────────────────────┘
              │
              ▼
    5. Create session
       ┌───────────────────────────┐
       │ Session created           │
       │ JSESSIONID cookie set     │
       └───────────────────────────┘
              │
              ▼
    6. Redirect to original page
       ┌──────────────┐
       │   Browser    │  GET /students (authenticated)
       └──────────────┘
                        </pre>
                    </div>
                </section>

                <!-- Slide 14 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Password Security: BCrypt

                        <div class="danger-box">
                        **❌ NEVER Store Plain Text Passwords!**

                        ```java
                        // WRONG - Plain text
                        User user = new User();
                        user.setUsername("admin");
                        user.setPassword("admin123");  // ❌ DANGER!
                        userRepository.save(user);

                        // Database: { "username": "admin", "password": "admin123" }
                        ```

                        **Why this is TERRIBLE**:
                        - Anyone with database access sees all passwords
                        - If database leaks, all users compromised
                        - Users often reuse passwords across sites
                        - Violates security best practices
                        - Legal/compliance issues (GDPR, HIPAA)
                        </div>

                        <div class="success-box">
                        **✅ CORRECT - BCrypt Hashed Password**

                        ```java
                        // CORRECT - Hashed password
                        User user = new User();
                        user.setUsername("admin");
                        user.setPassword(passwordEncoder.encode("admin123"));  // ✅ SAFE
                        userRepository.save(user);

                        // Database: { "username": "admin",
                        //             "password": "$2a$10$N9qo8uLOickgx2ZMRZoMye..." }
                        ```

                        **Benefits**:
                        - Original password cannot be recovered
                        - Each password has unique salt
                        - Industry standard algorithm
                        </div>
                    </textarea>
                </section>

                <!-- Slide 15 -->
                <section data-markdown>
                    <textarea data-template>
                        ### BCrypt How It Works

                        **BCrypt Algorithm**:
                        ```
                        Input:  "admin123"
                        Salt:   $2a$10$N9qo8uLOickgx2ZMRZoMye  (random, unique)
                        Hash:   $2a$10$N9qo8uLOickgx2ZMRZoMyeIX0bSeUxoAXDQ1ZPKwKVE7Xd9w5qZUW
                                 │   │  │                           │
                                 │   │  │                           └─ Actual hash
                                 │   │  └─ Salt (22 characters)
                                 │   └─ Cost factor (10 = 2^10 iterations)
                                 └─ Algorithm identifier ($2a = BCrypt)
                        ```

                        **Properties**:
                        - **One-way**: Cannot reverse hash to get password
                        - **Salted**: Same password = different hash
                        - **Slow**: Makes brute-force attacks impractical
                        - **Adaptive**: Can increase cost factor over time

                        **Example**:
                        ```java
                        String password = "admin123";

                        // Hash 1: $2a$10$abc...xyz
                        // Hash 2: $2a$10$def...uvw  ← Different salt!
                        // Both are valid for "admin123"
                        ```
                    </textarea>
                </section>
            </section>

            <!-- Section 3: Spring Security Configuration -->
            <section>
                <section data-markdown>
                    <textarea data-template>
                        ## 3. Spring Security Configuration

                        Enterprise-grade security
                    </textarea>
                </section>

                <!-- Slide 16 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Spring Security Dependencies

                        **pom.xml**:
                        ```xml
                        <dependencies>
                            <!-- Spring Security -->
                            <dependency>
                                <groupId>org.springframework.boot</groupId>
                                <artifactId>spring-boot-starter-security</artifactId>
                            </dependency>

                            <!-- OAuth2 Client (for Google Login) -->
                            <dependency>
                                <groupId>org.springframework.boot</groupId>
                                <artifactId>spring-boot-starter-oauth2-client</artifactId>
                            </dependency>
                        </dependencies>
                        ```

                        **What Spring Security Provides**:
                        - Authentication (login)
                        - Authorization (access control)
                        - CSRF protection
                        - Session management
                        - Password encoding
                        - Remember-me functionality
                        - OAuth2 integration
                    </textarea>
                </section>

                <!-- Slide 17 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Security Configuration (Part 1)

                        **From our project** - `SecurityConfig.java`:
                        ```java
                        package com.example.webapp.config;

                        import org.springframework.context.annotation.Bean;
                        import org.springframework.context.annotation.Configuration;
                        import org.springframework.security.config.annotation.web.builders.HttpSecurity;
                        import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
                        import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
                        import org.springframework.security.crypto.password.PasswordEncoder;
                        import org.springframework.security.web.SecurityFilterChain;

                        @Configuration
                        @EnableWebSecurity  // Enable Spring Security
                        public class SecurityConfig {

                            @Bean
                            public PasswordEncoder passwordEncoder() {
                                return new BCryptPasswordEncoder();  // Use BCrypt for passwords
                            }

                            // Continued on next slide...
                        }
                        ```
                    </textarea>
                </section>

                <!-- Slide 18 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Security Configuration (Part 2) - User Details

                        **From our project** - Creating in-memory users:
                        ```java
                        @Bean
                        public UserDetailsService userDetailsService() {
                            // Create admin user
                            UserDetails admin = User.builder()
                                .username("admin")
                                .password(passwordEncoder().encode("admin"))  // BCrypt hash
                                .roles("ADMIN")  // ROLE_ADMIN
                                .build();

                            // Create regular user
                            UserDetails user = User.builder()
                                .username("user")
                                .password(passwordEncoder().encode("user"))  // BCrypt hash
                                .roles("USER")  // ROLE_USER
                                .build();

                            return new InMemoryUserDetailsManager(admin, user);
                        }
                        ```

                        **Test Credentials**:
                        - **Admin**: username=`admin`, password=`admin`
                        - **User**: username=`user`, password=`user`

                        **Note**: In production, load users from database!
                    </textarea>
                </section>

                <!-- Slide 19 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Security Configuration (Part 3) - HTTP Security

                        **From our project** - `SecurityConfig.java`:
                        ```java
                        @Bean
                        public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
                            http
                                .csrf(csrf -> csrf.disable())  // Disable CSRF for development
                                .authorizeHttpRequests(authorize -> authorize
                                    // Public pages (no login required)
                                    .requestMatchers("/", "/home.html", "/login.html", "/login-form.html",
                                                    "/css/**", "/js/**", "/assets/**").permitAll()

                                    // API endpoints - require authentication
                                    .requestMatchers("/api/students/**").hasAnyRole("ADMIN", "USER")
                                    .requestMatchers("/api/subjects/**").hasAnyRole("ADMIN", "USER")
                                    .requestMatchers("/api/classes/**").hasRole("ADMIN")  // Admin only!

                                    // All other requests require authentication
                                    .anyRequest().authenticated()
                                )
                                // Continued on next slide...
                        }
                        ```
                    </textarea>
                </section>

                <!-- Slide 20 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Security Configuration (Part 4) - Login & Logout

                        **From our project** - Form login + OAuth2:
                        ```java
                                // ... continued from previous slide
                                .formLogin(form -> form
                                    .loginPage("/login-form.html")  // Custom login page
                                    .loginProcessingUrl("/login")  // POST endpoint for login
                                    .defaultSuccessUrl("/index", true)  // Redirect after login
                                    .failureUrl("/login-form.html?error=true")  // Redirect on failure
                                    .permitAll()
                                )
                                .oauth2Login(oauth2 -> oauth2
                                    .loginPage("/login.html")  // OAuth2 login page
                                    .defaultSuccessUrl("/index", true)  // Redirect after OAuth2 login
                                )
                                .logout(logout -> logout
                                    .logoutSuccessUrl("/")  // Redirect after logout
                                    .permitAll()
                                );

                            return http.build();
                        }
                        ```

                        **Features Configured**:
                        - Form-based login
                        - OAuth2 (Google) login
                        - Custom login pages
                        - Logout functionality
                    </textarea>
                </section>

                <!-- Slide 21 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Role-Based Access Control

                        **Access Rules from our project**:

                        | Endpoint | Admin | User | Anonymous |
                        |----------|-------|------|-----------|
                        | `/` (home page) | ✅ | ✅ | ✅ |
                        | `/login.html` | ✅ | ✅ | ✅ |
                        | `/css/**`, `/js/**` | ✅ | ✅ | ✅ |
                        | `GET /api/students` | ✅ | ✅ | ❌ |
                        | `POST /api/students` | ✅ | ✅ | ❌ |
                        | `PUT /api/students/{id}` | ✅ | ✅ | ❌ |
                        | `DELETE /api/students/{id}` | ✅ | ✅ | ❌ |
                        | `GET /api/classes` | ✅ | ❌ | ❌ |
                        | `POST /api/classes` | ✅ | ❌ | ❌ |

                        **Configuration**:
                        ```java
                        .requestMatchers("/api/students/**").hasAnyRole("ADMIN", "USER")
                        .requestMatchers("/api/subjects/**").hasAnyRole("ADMIN", "USER")
                        .requestMatchers("/api/classes/**").hasRole("ADMIN")
                        ```
                    </textarea>
                </section>
            </section>

            <!-- Section 4: Form-Based Login -->
            <section>
                <section data-markdown>
                    <textarea data-template>
                        ## 4. Form-Based Login

                        Traditional username/password login
                    </textarea>
                </section>

                <!-- Slide 22 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Login Form HTML

                        **From our project** - `login-form.html`:
                        ```html
                        <div class="card shadow-lg">
                          <div class="card-body p-5">
                            <div class="text-center mb-4">
                              <i class="fas fa-user-circle fa-4x text-primary mb-3"></i>
                              <h2 class="card-title fw-bold">Welcome Back</h2>
                              <p class="text-muted">Sign in to your account</p>
                            </div>

                            <!-- Login Form -->
                            <form action="/login" method="post">
                              <div class="mb-3">
                                <label for="username" class="form-label">Username</label>
                                <div class="input-group">
                                  <span class="input-group-text">
                                    <i class="fas fa-user"></i>
                                  </span>
                                  <input type="text" class="form-control" id="username"
                                         name="username" placeholder="Enter your username"
                                         required autofocus>
                                </div>
                              </div>

                              <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <div class="input-group">
                                  <span class="input-group-text">
                                    <i class="fas fa-lock"></i>
                                  </span>
                                  <input type="password" class="form-control" id="password"
                                         name="password" placeholder="Enter your password"
                                         required>
                                </div>
                              </div>

                              <div class="mb-3 form-check">
                                <input type="checkbox" class="form-check-input" id="remember"
                                       name="remember-me">
                                <label class="form-check-label" for="remember">
                                  Remember me
                                </label>
                              </div>

                              <div class="d-grid gap-2 mb-3">
                                <button type="submit" class="btn btn-primary btn-lg">
                                  <i class="fas fa-sign-in-alt me-2"></i>
                                  Sign In
                                </button>
                              </div>
                            </form>
                          </div>
                        </div>
                        ```
                    </textarea>
                </section>

                <!-- Slide 23 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Login Process Flow

                        **Step-by-step**:

                        1. **User visits protected page** (`/students`)
                           - Spring Security detects: not authenticated
                           - Redirects to `/login-form.html`

                        2. **User fills login form**:
                           - Username: `admin`
                           - Password: `admin`
                           - Submits form via POST to `/login`

                        3. **Spring Security processes login**:
                           - Calls `UserDetailsService.loadUserByUsername("admin")`
                           - Gets user from in-memory store
                           - Compares passwords using BCrypt:
                             ```java
                             passwordEncoder.matches("admin", storedHash)
                             ```

                        4. **On success**:
                           - Creates authentication token
                           - Creates session (JSESSIONID cookie)
                           - Redirects to `/index`

                        5. **On failure**:
                           - Redirects to `/login-form.html?error=true`
                    </textarea>
                </section>

                <!-- Slide 24 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Error Handling in Login Form

                        **Show error message** (from our project):
                        ```html
                        <!-- Error Message -->
                        <div id="error-message" class="alert alert-danger d-none" role="alert">
                          <i class="fas fa-exclamation-circle me-2"></i>
                          <span id="error-text">Invalid username or password</span>
                        </div>

                        <script>
                        // Check if error parameter exists in URL
                        const urlParams = new URLSearchParams(window.location.search);
                        if (urlParams.has('error')) {
                          // Show error message
                          document.getElementById('error-message').classList.remove('d-none');
                        }
                        </script>
                        ```

                        **URL with error**:
                        ```
                        /login-form.html?error=true
                        ```

                        **Result**: Red alert box appears with error message
                    </textarea>
                </section>
            </section>

            <!-- Section 5: OAuth2 with Google -->
            <section>
                <section data-markdown>
                    <textarea data-template>
                        ## 5. OAuth2 with Google Login

                        "Sign in with Google" button
                    </textarea>
                </section>

                <!-- Slide 25 -->
                <section data-markdown>
                    <textarea data-template>
                        ### What is OAuth2?

                        **OAuth 2.0** = Open Authorization Protocol

                        **Benefits**:
                        - ✅ Users don't create new passwords
                        - ✅ More secure (Google handles authentication)
                        - ✅ Faster registration process
                        - ✅ Users trust established providers
                        - ✅ Access to user profile data

                        **Example**: "Continue with Google" button you see on many websites

                        **How it works**:
                        1. User clicks "Login with Google"
                        2. Redirected to Google login page
                        3. User logs in with Google credentials
                        4. Google asks: "Allow this app access?"
                        5. User approves
                        6. Google redirects back with token
                        7. Your app verifies token
                        8. User is logged in!
                    </textarea>
                </section>

                <!-- Slide 26 -->
                <section>
                    <h3>OAuth2 Flow Diagram</h3>
                    <div class="diagram">
                        <pre style="color: black; font-size: 0.6em;">
    1. User clicks "Login with Google"
       ┌──────────────┐
       │   Browser    │  Click button
       └──────────────┘
              │
              ▼
    2. Redirect to Google
       ┌──────────────────────────────┐
       │  Spring Boot                 │  Redirect to:
       │  /oauth2/authorization/google │  accounts.google.com
       └──────────────────────────────┘
              │
              ▼
    3. User logs in with Google
       ┌──────────────────┐
       │  Google Login    │  Enter email & password
       │  accounts.google │
       └──────────────────┘
              │
              ▼
    4. User grants permission
       ┌──────────────────┐
       │  Consent Screen  │  "Allow access to email & profile?"
       └──────────────────┘
              │
              ▼
    5. Google redirects with code
       ┌───────────────────────────────────┐
       │  /login/oauth2/code/google?code=abc
       └───────────────────────────────────┘
              │
              ▼
    6. Exchange code for token
       ┌──────────────────┐
       │  Spring Security │  POST to Google:
       │                  │  - client_id
       │                  │  - client_secret
       │                  │  - code
       └──────────────────┘
              │
              ▼
    7. Get user info from Google
       ┌──────────────────┐
       │  Google API      │  Returns:
       │                  │  { "name": "John", "email": "john@gmail.com" }
       └──────────────────┘
              │
              ▼
    8. Create session & redirect
       ┌──────────────┐
       │   Browser    │  Redirected to /index (authenticated!)
       └──────────────┘
                        </pre>
                    </div>
                </section>

                <!-- Slide 27 -->
                <section data-markdown>
                    <textarea data-template>
                        ### OAuth2 Configuration

                        **application.properties**:
                        ```properties
                        # Google OAuth2 Configuration
                        spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID}
                        spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET}
                        spring.security.oauth2.client.registration.google.scope=profile,email

                        # Redirect URI (must match Google Console)
                        spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}
                        ```

                        **Environment Variables** (keep secrets safe):
                        ```bash
                        # Windows
                        set GOOGLE_CLIENT_ID=123456789-abc...xyz.apps.googleusercontent.com
                        set GOOGLE_CLIENT_SECRET=GOCSPX-abc...xyz

                        # Linux/macOS
                        export GOOGLE_CLIENT_ID="123456789-abc...xyz.apps.googleusercontent.com"
                        export GOOGLE_CLIENT_SECRET="GOCSPX-abc...xyz"
                        ```

                        **NEVER commit client secret to Git!**
                    </textarea>
                </section>

                <!-- Slide 28 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Google Login Button

                        **From our project** - `login.html`:
                        ```html
                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <title>Login - Web Application</title>
                            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
                                  rel="stylesheet">
                            <link rel="stylesheet"
                                  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
                        </head>
                        <body class="login-page">
                            <div class="container">
                                <div class="row justify-content-center align-items-center min-vh-100">
                                    <div class="col-md-5">
                                        <div class="card shadow-lg">
                                            <div class="card-body p-5">
                                                <div class="text-center mb-4">
                                                    <i class="fas fa-user-circle fa-4x text-primary mb-3"></i>
                                                    <h2 class="card-title fw-bold">Welcome</h2>
                                                    <p class="text-muted">Sign in to continue</p>
                                                </div>

                                                <div class="d-grid gap-2">
                                                    <!-- Google Login Button -->
                                                    <a href="/oauth2/authorization/google"
                                                       class="btn btn-google btn-lg">
                                                        <i class="fab fa-google me-2"></i>
                                                        Sign in with Google
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </body>
                        </html>
                        ```

                        **Key**: Link to `/oauth2/authorization/google` triggers OAuth2 flow
                    </textarea>
                </section>

                <!-- Slide 29 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Login Form with Both Options

                        **From our project** - Combined form + OAuth2:
                        ```html
                        <!-- Traditional Login Form -->
                        <form action="/login" method="post">
                          <div class="mb-3">
                            <input type="text" name="username" class="form-control"
                                   placeholder="Username" required>
                          </div>
                          <div class="mb-3">
                            <input type="password" name="password" class="form-control"
                                   placeholder="Password" required>
                          </div>
                          <button type="submit" class="btn btn-primary w-100">
                            <i class="fas fa-sign-in-alt me-2"></i>
                            Sign In
                          </button>
                        </form>

                        <!-- Divider -->
                        <div class="text-center">
                          <hr class="my-4">
                          <p class="text-muted mb-3">Or sign in with</p>

                          <!-- Google Login Button -->
                          <a href="/oauth2/authorization/google" class="btn btn-google w-100">
                            <i class="fab fa-google me-2"></i>
                            Sign in with Google
                          </a>
                        </div>
                        ```

                        **Users can choose**:
                        1. Traditional login (username/password)
                        2. Google login (OAuth2)
                    </textarea>
                </section>

                <!-- Slide 30 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Getting OAuth2 User Info

                        **From our project** - `UserController.java`:
                        ```java
                        @RestController
                        @RequestMapping("/api")
                        public class UserController {

                            /**
                             * Get current authenticated user information
                             * Supports both OAuth2 (Google) and form-based login
                             */
                            @GetMapping("/user")
                            public ResponseEntity<Map<String, Object>> getCurrentUser(
                                    Authentication authentication,
                                    @AuthenticationPrincipal OAuth2User oAuth2User,
                                    @AuthenticationPrincipal UserDetails userDetails) {

                                Map<String, Object> userInfo = new HashMap<>();

                                // Check if user logged in via OAuth2 (Google)
                                if (oAuth2User != null) {
                                    userInfo.put("name", oAuth2User.getAttribute("name"));
                                    userInfo.put("email", oAuth2User.getAttribute("email"));
                                    userInfo.put("picture", oAuth2User.getAttribute("picture"));
                                }
                                // Check if user logged in via form login
                                else if (userDetails != null) {
                                    userInfo.put("name", userDetails.getUsername());
                                    userInfo.put("email", userDetails.getUsername() + "@example.com");
                                }

                                return ResponseEntity.ok(userInfo);
                            }
                        }
                        ```
                    </textarea>
                </section>

                <!-- Slide 31 -->
                <section data-markdown>
                    <textarea data-template>
                        ### OAuth2 User Response

                        **GET** `/api/user` after Google login:

                        ```json
                        {
                          "name": "John Doe",
                          "email": "john.doe@gmail.com",
                          "picture": "https://lh3.googleusercontent.com/a/ABC123...",
                          "roles": "ROLE_USER",
                          "isAdmin": false
                        }
                        ```

                        **GET** `/api/user` after form login:

                        ```json
                        {
                          "name": "admin",
                          "email": "admin@example.com",
                          "picture": "https://ui-avatars.com/api/?name=admin",
                          "roles": "ROLE_ADMIN",
                          "isAdmin": true
                        }
                        ```

                        **Frontend can use this** to show user info and control UI
                    </textarea>
                </section>
            </section>

            <!-- Section 6: Getting Current User -->
            <section>
                <section data-markdown>
                    <textarea data-template>
                        ## 6. Getting Current User Information

                        Accessing authenticated user data
                    </textarea>
                </section>

                <!-- Slide 32 -->
                <section data-markdown>
                    <textarea data-template>
                        ### UserController - Complete Implementation

                        **From our project**:
                        ```java
                        @RestController
                        @RequestMapping("/api")
                        public class UserController {

                            @GetMapping("/user")
                            public ResponseEntity<Map<String, Object>> getCurrentUser(
                                    Authentication authentication,
                                    @AuthenticationPrincipal OAuth2User oAuth2User,
                                    @AuthenticationPrincipal UserDetails userDetails) {

                                Map<String, Object> userInfo = new HashMap<>();

                                // OAuth2 (Google) user
                                if (oAuth2User != null) {
                                    userInfo.put("name", oAuth2User.getAttribute("name"));
                                    userInfo.put("email", oAuth2User.getAttribute("email"));
                                    userInfo.put("picture", oAuth2User.getAttribute("picture"));
                                }
                                // Form login user
                                else if (userDetails != null) {
                                    userInfo.put("name", userDetails.getUsername());
                                    userInfo.put("email", userDetails.getUsername() + "@example.com");
                                    userInfo.put("picture",
                                        "https://ui-avatars.com/api/?name=" + userDetails.getUsername());
                                }

                                // Add role information (works for both)
                                if (authentication != null) {
                                    String roles = authentication.getAuthorities().stream()
                                        .map(GrantedAuthority::getAuthority)
                                        .collect(Collectors.joining(","));
                                    userInfo.put("roles", roles);

                                    boolean isAdmin = authentication.getAuthorities().stream()
                                        .anyMatch(a -> a.getAuthority().equals("ROLE_ADMIN"));
                                    userInfo.put("isAdmin", isAdmin);
                                }

                                return ResponseEntity.ok(userInfo);
                            }
                        }
                        ```
                    </textarea>
                </section>

                <!-- Slide 33 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Frontend: Display User Info

                        **Vue.js example**:
                        ```javascript
                        const app = Vue.createApp({
                          data() {
                            return {
                              currentUser: null,
                              isLoading: true
                            };
                          },
                          computed: {
                            isAuthenticated() {
                              return this.currentUser !== null;
                            },
                            isAdmin() {
                              return this.currentUser?.isAdmin === true;
                            }
                          },
                          methods: {
                            async loadCurrentUser() {
                              try {
                                const response = await fetch('/api/user', {
                                  credentials: 'include'  // Important: include cookies
                                });
                                if (response.ok) {
                                  this.currentUser = await response.json();
                                } else {
                                  // Not authenticated - redirect to login
                                  window.location.href = '/login.html';
                                }
                              } catch (error) {
                                console.error('Error loading user:', error);
                              } finally {
                                this.isLoading = false;
                              }
                            },
                            async logout() {
                              window.location.href = '/logout';
                            }
                          },
                          mounted() {
                            this.loadCurrentUser();
                          }
                        });
                        app.mount('#app');
                        ```
                    </textarea>
                </section>

                <!-- Slide 34 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Frontend: Conditional Rendering

                        **Show/hide based on role**:
                        ```html
                        <div id="app">
                          <!-- Loading state -->
                          <div v-if="isLoading" class="text-center">
                            <div class="spinner-border" role="status"></div>
                            <p>Loading...</p>
                          </div>

                          <!-- Authenticated -->
                          <div v-else-if="isAuthenticated">
                            <!-- User info -->
                            <div class="user-info">
                              <img :src="currentUser.picture" alt="Profile" class="rounded-circle">
                              <span>{{ currentUser.name }}</span>
                              <span class="badge bg-primary">{{ currentUser.roles }}</span>
                            </div>

                            <!-- Admin-only buttons -->
                            <div v-if="isAdmin">
                              <button @click="deleteStudent(student)" class="btn btn-danger">
                                <i class="fas fa-trash"></i> Delete
                              </button>
                              <button @click="showAdminPanel()" class="btn btn-warning">
                                <i class="fas fa-cog"></i> Admin Panel
                              </button>
                            </div>

                            <!-- Regular user message -->
                            <div v-else>
                              <p class="text-muted">
                                <i class="fas fa-info-circle"></i>
                                You don't have permission to delete records
                              </p>
                            </div>

                            <button @click="logout()" class="btn btn-secondary">Logout</button>
                          </div>

                          <!-- Not authenticated -->
                          <div v-else>
                            <p>Please <a href="/login.html">login</a> to continue</p>
                          </div>
                        </div>
                        ```
                    </textarea>
                </section>
            </section>

            <!-- Section 7: Session Management -->
            <section>
                <section data-markdown>
                    <textarea data-template>
                        ## 7. Session Management

                        Keeping users logged in
                    </textarea>
                </section>

                <!-- Slide 35 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Session Configuration

                        **application.properties**:
                        ```properties
                        # Session timeout (30 minutes of inactivity)
                        server.servlet.session.timeout=30m

                        # Session cookie name
                        server.servlet.session.cookie.name=JSESSIONID

                        # Security settings
                        server.servlet.session.cookie.http-only=true  # Prevent JavaScript access
                        server.servlet.session.cookie.secure=false     # false for dev, true for prod (HTTPS)
                        server.servlet.session.cookie.same-site=lax    # CSRF protection
                        ```

                        **Session Lifecycle**:
                        1. User logs in → Session created
                        2. Browser stores JSESSIONID cookie
                        3. Each request includes cookie
                        4. Session expires after 30 minutes of inactivity
                        5. User logs out → Session destroyed
                    </textarea>
                </section>

                <!-- Slide 36 -->
                <section>
                    <h3>How Sessions Work</h3>
                    <div class="diagram">
                        <pre style="color: black; font-size: 0.65em;">
    1. User logs in successfully
       ┌──────────────────────┐
       │  Spring Security     │
       │  - Validates credentials
       │  - Creates session
       └──────────────────────┘
              │
              ▼
    2. Session stored in memory
       ┌─────────────────────────────────┐
       │  Session Store (in-memory)      │
       │  ───────────────────────────────│
       │  JSESSIONID: ABC123...          │
       │  - username: "admin"            │
       │  - roles: ["ROLE_ADMIN"]        │
       │  - createdAt: 2024-11-10 10:00 │
       │  - lastAccessed: 2024-11-10 10:00
       └─────────────────────────────────┘
              │
              ▼
    3. Send cookie to browser
       ┌──────────────────────┐
       │  HTTP Response       │
       │  Set-Cookie: JSESSIONID=ABC123...; HttpOnly; Path=/
       └──────────────────────┘
              │
              ▼
    4. Browser stores cookie
       ┌──────────────────────┐
       │  Browser             │
       │  Cookies:            │
       │  - JSESSIONID=ABC123
       └──────────────────────┘
              │
              ▼
    5. Subsequent requests include cookie
       ┌──────────────────────┐
       │  HTTP Request        │
       │  GET /api/students   │
       │  Cookie: JSESSIONID=ABC123
       └──────────────────────┘
              │
              ▼
    6. Spring Security validates session
       ┌──────────────────────┐
       │  Lookup session      │
       │  Found: admin (ADMIN)│
       │  Update lastAccessed │
       └──────────────────────┘
                        </pre>
                    </div>
                </section>

                <!-- Slide 37 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Logout Implementation

                        **Backend** (already configured in SecurityConfig):
                        ```java
                        .logout(logout -> logout
                            .logoutSuccessUrl("/")  // Redirect after logout
                            .permitAll()
                        );
                        ```

                        **Frontend** - JavaScript:
                        ```javascript
                        async function logout() {
                          try {
                            // Option 1: Redirect to logout endpoint
                            window.location.href = '/logout';

                            // Option 2: POST to logout (if CSRF enabled)
                            await fetch('/logout', {
                              method: 'POST',
                              credentials: 'include'
                            });
                            window.location.href = '/';
                          } catch (error) {
                            console.error('Logout failed:', error);
                          }
                        }
                        ```

                        **What happens**:
                        1. Session destroyed on server
                        2. JSESSIONID cookie invalidated
                        3. User redirected to home page
                        4. Future requests require re-login
                    </textarea>
                </section>
            </section>

            <!-- Section 8: Testing -->
            <section>
                <section data-markdown>
                    <textarea data-template>
                        ## 8. Testing Authentication & Security

                        Verifying everything works
                    </textarea>
                </section>

                <!-- Slide 38 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Testing Checklist

                        **1. Test Form Login**:
                        - Visit `/login-form.html`
                        - Try invalid credentials → Should show error
                        - Try valid credentials (admin/admin) → Should redirect to `/index`
                        - Check you can access protected pages
                        - Try logout → Should redirect to `/`

                        **2. Test OAuth2 Login**:
                        - Visit `/login.html`
                        - Click "Sign in with Google"
                        - Complete Google login
                        - Should redirect to `/index`
                        - Check `/api/user` shows Google profile

                        **3. Test Role-Based Access**:
                        - Login as admin → Can access `/api/classes`
                        - Login as user → Cannot access `/api/classes` (403 Forbidden)
                        - Check delete buttons visible only for admin

                        **4. Test Session**:
                        - Login → Close browser → Open again
                        - Should still be logged in (if within timeout)
                        - Wait 30 minutes → Session should expire
                    </textarea>
                </section>

                <!-- Slide 39 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Testing with Postman

                        **Test 1: Login**
                        ```http
                        POST http://localhost:8080/login
                        Content-Type: application/x-www-form-urlencoded

                        username=admin&password=admin
                        ```
                        **Response**: 302 Redirect + Set-Cookie: JSESSIONID=...

                        **Test 2: Access Protected Endpoint**
                        ```http
                        GET http://localhost:8080/api/students
                        Cookie: JSESSIONID=ABC123...
                        ```
                        **Response**: 200 OK + student list

                        **Test 3: Access Without Cookie**
                        ```http
                        GET http://localhost:8080/api/students
                        (no cookie)
                        ```
                        **Response**: 401 Unauthorized or 302 Redirect to login

                        **Test 4: Access Admin-Only Endpoint**
                        ```http
                        GET http://localhost:8080/api/classes
                        Cookie: JSESSIONID=USER_SESSION...
                        ```
                        **Response**: 403 Forbidden (if logged in as USER)
                    </textarea>
                </section>

                <!-- Slide 40 -->
                <section data-markdown>
                    <textarea data-template>
                        ### Common Issues & Solutions

                        **Issue 1: CORS Error with Credentials**
                        ```
                        Error: Request credentials mode 'include' not supported
                        ```
                        **Solution**:
                        ```java
                        @Configuration
                        public class CorsConfig {
                            @Bean
                            public WebMvcConfigurer corsConfigurer() {
                                return new WebMvcConfigurer() {
                                    @Override
                                    public void addCorsMappings(CorsRegistry registry) {
                                        registry.addMapping("/api/**")
                                            .allowedOrigins("http://localhost:5500")
                                            .allowedMethods("GET", "POST", "PUT", "DELETE")
                                            .allowCredentials(true);  // Important!
                                    }
                                };
                            }
                        }
                        ```

                        **Issue 2: Session Not Persisting**
                        ```javascript
                        // Wrong - no credentials
                        fetch('/api/students')

                        // Correct - include credentials
                        fetch('/api/students', {
                          credentials: 'include'  // Include cookies!
                        })
                        ```

                        **Issue 3: OAuth2 Redirect URI Mismatch**
                        - Check Google Console redirect URI matches:
                          `http://localhost:8080/login/oauth2/code/google`
                    </textarea>
                </section>
            </section>

            <!-- Summary & Lab -->
            <section>
                <!-- Slide 41 -->
                <section data-markdown>
                    <textarea data-template>
                        ## Module 4 Summary

                        What we learned:

                        1. ✅ Frontend & backend data validation
                        2. ✅ Jakarta Bean Validation annotations
                        3. ✅ Password security with BCrypt
                        4. ✅ Spring Security configuration
                        5. ✅ Form-based login implementation
                        6. ✅ OAuth2 with Google Login
                        7. ✅ Role-Based Access Control (RBAC)
                        8. ✅ Getting current user information
                        9. ✅ Session management
                        10. ✅ Testing authentication & security

                        **Result**: Secure application with proper authentication and authorization!
                    </textarea>
                </section>

                <!-- Slide 42 -->
                <section data-markdown>
                    <textarea data-template>
                        ## Lab Exercise

                        **Assignment**: Add complete authentication to Subject Management

                        **Requirements**:

                        **Backend**:
                        1. Add validation annotations to Subject entity
                        2. Configure Spring Security (already done!)
                        3. Test role-based access:
                           - Admin: Can create/update/delete subjects
                           - User: Can only view subjects
                        4. Add `/api/user` endpoint to get current user

                        **Frontend**:
                        1. Add login page (use template from our project)
                        2. Display current user info in navbar
                        3. Show/hide delete buttons based on role
                        4. Add logout button
                        5. Redirect to login if not authenticated

                        **Bonus**: Implement "Remember Me" functionality
                    </textarea>
                </section>

                <!-- Slide 43 -->
                <section data-markdown>
                    <textarea data-template>
                        ## Lab Submission

                        **Due**: 2 weeks from today
                        **Weight**: 10% of final grade

                        **Deliverables**:
                        1. **Source code** (zipped or GitHub)
                        2. **Screenshots**:
                           - Login page
                           - Successful login
                           - User info displayed
                           - Admin view (with delete buttons)
                           - User view (without delete buttons)
                           - 403 error when user tries admin action
                           - OAuth2 Google login (if implemented)
                        3. **Demo video** (5 minutes):
                           - Login as admin → Create/delete subject
                           - Login as user → View only, cannot delete
                           - Logout → Redirect to login

                        **Grading**:
                        - Validation: 20%
                        - Authentication: 30%
                        - Authorization (RBAC): 30%
                        - Frontend Integration: 15%
                        - Documentation: 5%
                    </textarea>
                </section>

                <!-- Slide 44 -->
                <section data-markdown>
                    <textarea data-template>
                        ## Additional Resources

                        **Documentation**:
                        - Spring Security: https://spring.io/projects/spring-security
                        - Spring Security Reference: https://docs.spring.io/spring-security/reference/
                        - Jakarta Bean Validation: https://beanvalidation.org/
                        - OAuth 2.0: https://oauth.net/2/
                        - Google OAuth2: https://developers.google.com/identity/protocols/oauth2

                        **Tutorials**:
                        - Spring Security Guide: https://spring.io/guides/gs/securing-web/
                        - OAuth2 with Spring Boot: https://spring.io/guides/tutorials/spring-boot-oauth2/
                        - BCrypt Password Encoder: https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/crypto/bcrypt/BCryptPasswordEncoder.html

                        **Security Best Practices**:
                        - OWASP Top 10: https://owasp.org/www-project-top-ten/
                        - Password Storage: https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html
                    </textarea>
                </section>

                <!-- Slide 45 -->
                <section data-markdown>
                    <textarea data-template>
                        ## Next Module Preview

                        **Module 5: Advanced Features, Best Practices & Deployment**

                        Topics:
                        - Code organization & architecture
                        - Auto-generation features
                        - Data initialization & migration
                        - Building production-ready JAR
                        - Environment configuration
                        - Deployment to Heroku, AWS, VPS
                        - Monitoring & logging
                        - Documentation writing
                        - Final project requirements

                        **Get ready to deploy your application!** 🚀

                        ---

                        **Thank you!**

                        Questions?
                    </textarea>
                </section>
            </section>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/highlight/highlight.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/notes/notes.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            slideNumber: true,
            transition: 'slide',
            plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
        });
    </script>
</body>
</html>
